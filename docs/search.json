[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.6\n✔ forcats   1.0.1     ✔ stringr   1.6.0\n✔ ggplot2   4.0.1     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.2.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(geosphere)\n\nmay_schedule &lt;- read.csv(\"MAY_AA_SCHEDULE.csv\")\nhead(may_schedule, 20)\n\n     Date Away_Team Home_Team  X X.1 X.2 X.3\n1  May 14        FM       CLE NA  NA  NA  NA\n2  May 15        FM       CLE NA  NA  NA  NA\n3                KC       KCO NA  NA  NA  NA\n4                SC       CHI NA  NA  NA  NA\n5               WPG       MKE NA  NA  NA  NA\n6               GAR        LC NA  NA  NA  NA\n7               SF        LIN NA  NA  NA  NA\n8  May 16        FM       CLE NA  NA  NA  NA\n9                KC       KCO NA  NA  NA  NA\n10               SC       CHI NA  NA  NA  NA\n11              WPG       MKE NA  NA  NA  NA\n12              GAR        LC NA  NA  NA  NA\n13              SF        LIN NA  NA  NA  NA\n14 May 17        FM       CLE NA  NA  NA  NA\n15               KC       KCO NA  NA  NA  NA\n16               SC       CHI NA  NA  NA  NA\n17              WPG       MKE NA  NA  NA  NA\n18              GAR        LC NA  NA  NA  NA\n19              SF        LIN NA  NA  NA  NA\n20 May 18       FM        CLE NA  NA  NA  NA\n\nschedule_clean &lt;- may_schedule %&gt;%\n  select(Date, Home_Team, Away_Team) %&gt;%\n  filter(!is.na(Home_Team) & !is.na(Away_Team)) %&gt;%\n  mutate(Date = na_if(Date, \"\")) %&gt;%\n  fill(Date, .direction = \"down\")\n\nhead(schedule_clean, 20)\n\n     Date Home_Team Away_Team\n1  May 14       CLE        FM\n2  May 15       CLE        FM\n3  May 15       KCO        KC\n4  May 15       CHI        SC\n5  May 15       MKE       WPG\n6  May 15        LC       GAR\n7  May 15       LIN       SF \n8  May 16       CLE        FM\n9  May 16       KCO        KC\n10 May 16       CHI        SC\n11 May 16       MKE       WPG\n12 May 16        LC       GAR\n13 May 16       LIN       SF \n14 May 17       CLE        FM\n15 May 17       KCO        KC\n16 May 17       CHI        SC\n17 May 17       MKE       WPG\n18 May 17        LC       GAR\n19 May 17       LIN       SF \n20 May 18       CLE       FM \n\nballparks &lt;- read.csv(\"ballparks.csv\")\nhead(ballparks)\n\n                      Team       City State     lat      lon nickname\n1             Chicago Dogs   Rosemont    IL 41.9742 -87.8826      CHI\n2  Fargo-Moorhead RedHawks      Fargo    ND 46.8772 -96.7898       FM\n3 Gary SouthShore RailCats       Gary    IN 41.5934 -87.3365      GAR\n4      Kane County Cougars     Geneva    IL 41.8878 -88.3206      KCO\n5  Lake Country DockHounds Oconomowoc    WI 43.1117 -88.4993       LC\n6         Lincoln Saltdogs    Lincoln    NE 40.8508 -96.7008      LIN\n\nfirst_game &lt;- schedule_clean[1,]\nsecond_game &lt;- schedule_clean[2,]\nprint(first_game)\n\n    Date Home_Team Away_Team\n1 May 14       CLE        FM\n\nprint(second_game)\n\n    Date Home_Team Away_Team\n2 May 15       CLE        FM\n\nhome_info &lt;- ballparks %&gt;% filter(nickname == first_game$Home_Team)\naway_info &lt;- ballparks %&gt;% filter(nickname == first_game$Away_Team)\nprint(away_info)\n\n                     Team  City State     lat      lon nickname\n1 Fargo-Moorhead RedHawks Fargo    ND 46.8772 -96.7898       FM\n\nprint(home_info)\n\n                  Team     City State     lat      lon nickname\n1 Cleburne Railroaders Cleburne    TX 32.3479 -97.3867      CLE\n\n# Distance calculation function\ncalc_distance &lt;- function(lat1, lon1, lat2, lon2) {\n  distHaversine(c(lon1, lat1), c(lon2, lat2)) / 1609.34  # converts to miles\n}\n\n# Get coordinates\nhome_lat &lt;- home_info$lat\nhome_lon &lt;- home_info$lon\naway_lat &lt;- away_info$lat\naway_lon &lt;- away_info$lon\n\n# Calculate distance\ndistance &lt;- calc_distance(away_lat, away_lon, home_lat, home_lon)\nprint(paste(\"Distance from CLE to FM:\", round(distance, 0), \"miles\"))\n\n[1] \"Distance from CLE to FM: 1005 miles\"\n\n# Sort by away team and date\nschedule_sorted &lt;- schedule_clean %&gt;%\n  arrange(Away_Team, Date)\n\n# Add a column that shows if they're in a new city\nschedule_with_travel &lt;- schedule_sorted %&gt;%\n  group_by(Away_Team) %&gt;%\n  mutate(\n    prev_city = lag(Home_Team),  # Where they played last game\n    new_trip = (Home_Team != prev_city) | is.na(prev_city)  # TRUE if new city\n  ) %&gt;%\n  ungroup()\n\n# Look at this\nschedule_with_travel %&gt;%\n  select(Date, Away_Team, Home_Team, prev_city, new_trip) %&gt;%\n  head(20)\n\n# A tibble: 20 × 5\n   Date   Away_Team Home_Team prev_city new_trip\n   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;     &lt;lgl&gt;   \n 1 May 19 CHI       KC        &lt;NA&gt;      TRUE    \n 2 May 20 CHI       KC        KC        FALSE   \n 3 May 21 CHI       KC        KC        FALSE   \n 4 May 22 CHI       SF        KC        TRUE    \n 5 May 23 CHI       SF        SF        FALSE   \n 6 May 24 CHI       SF        SF        FALSE   \n 7 May 22 CLE       GAR       &lt;NA&gt;      TRUE    \n 8 May 23 CLE       GAR       GAR       FALSE   \n 9 May 24 CLE       GAR       GAR       FALSE   \n10 May 26 CLE       CHI       GAR       TRUE    \n11 May 27 CLE       CHI       CHI       FALSE   \n12 May 28 CLE       CHI       CHI       FALSE   \n13 May 29 CLE       GAR       CHI       TRUE    \n14 May 30 CLE       GAR       GAR       FALSE   \n15 May 31 CLE       GAR       GAR       FALSE   \n16 May 14 FM        CLE       &lt;NA&gt;      TRUE    \n17 May 15 FM        CLE       CLE       FALSE   \n18 May 16 FM        CLE       CLE       FALSE   \n19 May 17 FM        CLE       CLE       FALSE   \n20 May 19 FM        CLE       CLE       FALSE   \n\n# Clean up extra spaces in team names\nschedule_clean &lt;- schedule_clean %&gt;%\n  mutate(\n    Home_Team = str_trim(Home_Team),\n    Away_Team = str_trim(Away_Team)\n  )\n\n# Now redo the travel detection\nschedule_sorted &lt;- schedule_clean %&gt;%\n  arrange(Away_Team, Date)\n\nschedule_with_travel &lt;- schedule_sorted %&gt;%\n  group_by(Away_Team) %&gt;%\n  mutate(\n    prev_city = lag(Home_Team),\n    new_trip = (Home_Team != prev_city) | is.na(prev_city)\n  ) %&gt;%\n  ungroup()\n\n# Check again\nschedule_with_travel %&gt;%\n  select(Date, Away_Team, Home_Team, prev_city, new_trip) %&gt;%\n  filter(Away_Team == \"CLE\") %&gt;%\n  head(10)\n\n# A tibble: 9 × 5\n  Date   Away_Team Home_Team prev_city new_trip\n  &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;     &lt;lgl&gt;   \n1 May 22 CLE       GAR       &lt;NA&gt;      TRUE    \n2 May 23 CLE       GAR       GAR       FALSE   \n3 May 24 CLE       GAR       GAR       FALSE   \n4 May 26 CLE       CHI       GAR       TRUE    \n5 May 27 CLE       CHI       CHI       FALSE   \n6 May 28 CLE       CHI       CHI       FALSE   \n7 May 29 CLE       GAR       CHI       TRUE    \n8 May 30 CLE       GAR       GAR       FALSE   \n9 May 31 CLE       GAR       GAR       FALSE   \n\n# Join with coordinates\nschedule_with_coords &lt;- schedule_with_travel %&gt;%\n  left_join(ballparks %&gt;% select(nickname, home_lat = lat, home_lon = lon), \n            by = c(\"Home_Team\" = \"nickname\")) %&gt;%\n  left_join(ballparks %&gt;% select(nickname, away_lat = lat, away_lon = lon), \n            by = c(\"Away_Team\" = \"nickname\"))\n\n# Calculate distance only for NEW trips\nschedule_final &lt;- schedule_with_coords %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    miles = if_else(new_trip, \n                    calc_distance(away_lat, away_lon, home_lat, home_lon),\n                    0)  # 0 miles if staying in same city\n  ) %&gt;%\n  ungroup()\n\n# Show results\nschedule_final %&gt;%\n  select(Date, Away_Team, Home_Team, new_trip, miles) %&gt;%\n  print(n = 100)\n\n# A tibble: 92 × 5\n   Date   Away_Team Home_Team new_trip  miles\n   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;lgl&gt;     &lt;dbl&gt;\n 1 May 19 CHI       KC        TRUE      406. \n 2 May 20 CHI       KC        FALSE       0  \n 3 May 21 CHI       KC        FALSE       0  \n 4 May 22 CHI       SF        TRUE      462. \n 5 May 23 CHI       SF        FALSE       0  \n 6 May 24 CHI       SF        FALSE       0  \n 7 May 22 CLE       GAR       TRUE      846. \n 8 May 23 CLE       GAR       FALSE       0  \n 9 May 24 CLE       GAR       FALSE       0  \n10 May 26 CLE       CHI       TRUE      846. \n11 May 27 CLE       CHI       FALSE       0  \n12 May 28 CLE       CHI       FALSE       0  \n13 May 29 CLE       GAR       TRUE      846. \n14 May 30 CLE       GAR       FALSE       0  \n15 May 31 CLE       GAR       FALSE       0  \n16 May 14 FM        CLE       TRUE     1005. \n17 May 15 FM        CLE       FALSE       0  \n18 May 16 FM        CLE       FALSE       0  \n19 May 17 FM        CLE       FALSE       0  \n20 May 18 FM        CLE       FALSE       0  \n21 May 19 FM        CLE       FALSE       0  \n22 May 20 FM        CLE       FALSE       0  \n23 May 29 FM        SF        TRUE      231. \n24 May 30 FM        SF        FALSE       0  \n25 May 31 FM        SF        FALSE       0  \n26 May 15 GAR       LC        TRUE      121. \n27 May 16 GAR       LC        FALSE       0  \n28 May 17 GAR       LC        FALSE       0  \n29 May 18 GAR       MKE       TRUE       96.4\n30 May 19 GAR       MKE       FALSE       0  \n31 May 20 GAR       MKE       FALSE       0  \n32 May 15 KC        KCO       TRUE      383. \n33 May 16 KC        KCO       FALSE       0  \n34 May 17 KC        KCO       FALSE       0  \n35 May 25 KC        LIN       TRUE      163. \n36 May 26 KC        LIN       FALSE       0  \n37 May 27 KC        LIN       FALSE       0  \n38 May 19 KCO       WPG       TRUE      697. \n39 May 20 KCO       WPG       FALSE       0  \n40 May 21 KCO       WPG       FALSE       0  \n41 May 22 KCO       FM        TRUE      542. \n42 May 23 KCO       FM        FALSE       0  \n43 May 24 KCO       FM        FALSE       0  \n44 May 18 LC        SF        TRUE      415. \n45 May 19 LC        SF        FALSE       0  \n46 May 20 LC        SF        FALSE       0  \n47 May 21 LC        SF        FALSE       0  \n48 May 22 LC        KC        TRUE      422. \n49 May 23 LC        KC        FALSE       0  \n50 May 24 LC        KC        FALSE       0  \n51 May 26 LC        FM        TRUE      482. \n52 May 27 LC        FM        FALSE       0  \n53 May 28 LC        FM        FALSE       0  \n54 May 22 LIN       SC        TRUE      115. \n55 May 23 LIN       SC        FALSE       0  \n56 May 24 LIN       SC        FALSE       0  \n57 May 29 LIN       KCO       TRUE      441. \n58 May 30 LIN       KCO       FALSE       0  \n59 May 31 LIN       KCO       FALSE       0  \n60 May 22 MKE       WPG       TRUE      650. \n61 May 23 MKE       WPG       FALSE       0  \n62 May 24 MKE       WPG       FALSE       0  \n63 May 25 MKE       SC        TRUE      425. \n64 May 26 MKE       SC        FALSE       0  \n65 May 27 MKE       SC        FALSE       0  \n66 May 28 MKE       SC        FALSE       0  \n67 May 29 MKE       LC        TRUE       28.1\n68 May 30 MKE       LC        FALSE       0  \n69 May 31 MKE       LC        FALSE       0  \n70 May 15 SC        CHI       TRUE      437. \n71 May 16 SC        CHI       FALSE       0  \n72 May 17 SC        CHI       FALSE       0  \n73 May 19 SC        LIN       TRUE      115. \n74 May 20 SC        LIN       FALSE       0  \n75 May 21 SC        LIN       FALSE       0  \n76 May 29 SC        KC        TRUE      252. \n77 May 30 SC        KC        FALSE       0  \n78 May 31 SC        KC        FALSE       0  \n79 May 15 SF        LIN       TRUE      186. \n80 May 16 SF        LIN       FALSE       0  \n81 May 17 SF        LIN       FALSE       0  \n82 May 27 SF        KCO       TRUE      442. \n83 May 28 SF        KCO       FALSE       0  \n84 May 15 WPG       MKE       TRUE      650. \n85 May 16 WPG       MKE       FALSE       0  \n86 May 17 WPG       MKE       FALSE       0  \n87 May 26 WPG       GAR       TRUE      743. \n88 May 27 WPG       GAR       FALSE       0  \n89 May 28 WPG       GAR       FALSE       0  \n90 May 29 WPG       CHI       TRUE      705. \n91 May 30 WPG       CHI       FALSE       0  \n92 May 31 WPG       CHI       FALSE       0  \n\n# Total miles by team\n# team_travel_summary &lt;- schedule_final %&gt;%\n#   group_by(Away_Team) %&gt;%\n#   summarise(\n#     total_miles = round(sum(miles), 0),\n#     num_trips = sum(new_trip),\n#     total_games = n()\n#   ) %&gt;%\n#   arrange(desc(total_miles))\n# \n# team_travel_summary\n\ncalculate_team_travel &lt;- function(team_abbr) {\n  team_games &lt;- schedule_clean %&gt;%\n    filter(Home_Team == team_abbr | Away_Team == team_abbr) %&gt;%\n    arrange(Date) %&gt;%\n    mutate(\n      is_home = (Home_Team == team_abbr),\n      location = if_else(is_home, Home_Team, Home_Team)\n    )\n  current_location &lt;- team_abbr\n  total_miles &lt;- 0\n  trips &lt;-list()\n  \n  for(i in 1:nrow(team_games)) {\n    game &lt;- team_games[i,]\n    \n    if(game$is_home) {\n      # Home game - where are they coming from?\n      if(current_location != team_abbr) {\n        # Travel home\n        from_coords &lt;- ballparks %&gt;% filter(nickname == current_location)\n        to_coords &lt;- ballparks %&gt;% filter(nickname == team_abbr)\n        miles &lt;- calc_distance(from_coords$lat, from_coords$lon, \n                              to_coords$lat, to_coords$lon)\n        total_miles &lt;- total_miles + miles\n        trips[[length(trips) + 1]] &lt;- list(\n          from = current_location, \n          to = team_abbr, \n          miles = round(miles, 0),\n          date = game$Date\n        )\n        current_location &lt;- team_abbr\n      }\n    } else {\n      # Away game - are they already there?\n      away_location &lt;- game$Home_Team\n      if(current_location != away_location) {\n        # Travel to away city\n        from_coords &lt;- ballparks %&gt;% filter(nickname == current_location)\n        to_coords &lt;- ballparks %&gt;% filter(nickname == away_location)\n        miles &lt;- calc_distance(from_coords$lat, from_coords$lon,\n                              to_coords$lat, to_coords$lon)\n        total_miles &lt;- total_miles + miles\n        trips[[length(trips) + 1]] &lt;- list(\n          from = current_location,\n          to = away_location,\n          miles = round(miles, 0),\n          date = game$Date\n        )\n        current_location &lt;- away_location\n      }\n    }\n  }\n  \n  list(\n    team = team_abbr,\n    total_miles = round(total_miles, 0),\n    num_trips = length(trips),\n    ending_location = current_location,\n    trips = trips\n  )\n}\n\n# Test with Winnipeg\nwpg_travel &lt;- calculate_team_travel(\"WPG\")\nprint(wpg_travel) \n\n$team\n[1] \"WPG\"\n\n$total_miles\n[1] 2081\n\n$num_trips\n[1] 4\n\n$ending_location\n[1] \"CHI\"\n\n$trips\n$trips[[1]]\n$trips[[1]]$from\n[1] \"WPG\"\n\n$trips[[1]]$to\n[1] \"MKE\"\n\n$trips[[1]]$miles\n[1] 650\n\n$trips[[1]]$date\n[1] \"May 15\"\n\n\n$trips[[2]]\n$trips[[2]]$from\n[1] \"MKE\"\n\n$trips[[2]]$to\n[1] \"WPG\"\n\n$trips[[2]]$miles\n[1] 650\n\n$trips[[2]]$date\n[1] \"May 19\"\n\n\n$trips[[3]]\n$trips[[3]]$from\n[1] \"WPG\"\n\n$trips[[3]]$to\n[1] \"GAR\"\n\n$trips[[3]]$miles\n[1] 743\n\n$trips[[3]]$date\n[1] \"May 26\"\n\n\n$trips[[4]]\n$trips[[4]]$from\n[1] \"GAR\"\n\n$trips[[4]]$to\n[1] \"CHI\"\n\n$trips[[4]]$miles\n[1] 39\n\n$trips[[4]]$date\n[1] \"May 29\"\n\n# Show all WPG games in order\nwpg_games &lt;- schedule_clean %&gt;%\n  filter(Home_Team == \"WPG\" | Away_Team == \"WPG\") %&gt;%\n  arrange(Date) %&gt;%\n  mutate(\n    is_home = (Home_Team == \"WPG\"),\n    opponent = if_else(is_home, Away_Team, Home_Team),\n    venue = if_else(is_home, \"HOME\", \"AWAY\")\n  ) %&gt;%\n  select(Date, venue, opponent)\n\nprint(wpg_games)\n\n     Date venue opponent\n1  May 15  AWAY      MKE\n2  May 16  AWAY      MKE\n3  May 17  AWAY      MKE\n4  May 19  HOME      KCO\n5  May 20  HOME      KCO\n6  May 21  HOME      KCO\n7  May 22  HOME      MKE\n8  May 23  HOME      MKE\n9  May 24  HOME      MKE\n10 May 26  AWAY      GAR\n11 May 27  AWAY      GAR\n12 May 28  AWAY      GAR\n13 May 29  AWAY      CHI\n14 May 30  AWAY      CHI\n15 May 31  AWAY      CHI\n\n# Debug: Show raw schedule data for WPG\nschedule_clean %&gt;%\n  filter(Home_Team == \"WPG\" | Away_Team == \"WPG\") %&gt;%\n  arrange(Date) %&gt;%\n  select(Date, Home_Team, Away_Team) %&gt;%\n  head(10)\n\n     Date Home_Team Away_Team\n1  May 15       MKE       WPG\n2  May 16       MKE       WPG\n3  May 17       MKE       WPG\n4  May 19       WPG       KCO\n5  May 20       WPG       KCO\n6  May 21       WPG       KCO\n7  May 22       WPG       MKE\n8  May 23       WPG       MKE\n9  May 24       WPG       MKE\n10 May 26       GAR       WPG\n\nschedule_clean %&gt;%\n  filter(Home_Team == \"WPG\" | Away_Team == \"WPG\") %&gt;%\n  arrange(Date) %&gt;%\n  select(Date, Home_Team, Away_Team) %&gt;%\n  head(5)\n\n    Date Home_Team Away_Team\n1 May 15       MKE       WPG\n2 May 16       MKE       WPG\n3 May 17       MKE       WPG\n4 May 19       WPG       KCO\n5 May 20       WPG       KCO\n\nschedule_clean &lt;- read.csv(\"MAY_AA_SCHEDULE.csv\") %&gt;%\n  mutate(\n    Home_Team = str_trim(Home_Team),\n    Away_Team = str_trim(Away_Team),\n    Date = na_if(Date, \"\")\n  ) %&gt;%\n  fill(Date, .direction = \"down\") %&gt;%\n  filter(!is.na(Home_Team) & !is.na(Away_Team))\n\n# Check WPG now\nschedule_clean %&gt;%\n  filter(Home_Team == \"WPG\" | Away_Team == \"WPG\") %&gt;%\n  arrange(Date) %&gt;%\n  select(Date, Home_Team, Away_Team) \n\n     Date Home_Team Away_Team\n1  May 15       MKE       WPG\n2  May 16       MKE       WPG\n3  May 17       MKE       WPG\n4  May 19       WPG       KCO\n5  May 20       WPG       KCO\n6  May 21       WPG       KCO\n7  May 22       WPG       MKE\n8  May 23       WPG       MKE\n9  May 24       WPG       MKE\n10 May 26       GAR       WPG\n11 May 27       GAR       WPG\n12 May 28       GAR       WPG\n13 May 29       CHI       WPG\n14 May 30       CHI       WPG\n15 May 31       CHI       WPG\n\nschedule_sorted &lt;- schedule_clean %&gt;%\n  arrange(Away_Team, Date)\n\nschedule_with_travel &lt;- schedule_sorted %&gt;%\n  group_by(Away_Team) %&gt;%\n  mutate(\n    prev_city = lag(Home_Team),\n    new_trip = (Home_Team != prev_city) | is.na(prev_city)\n  ) %&gt;%\n  ungroup()\n\n# Join with coordinates and calculate\nschedule_with_coords &lt;- schedule_with_travel %&gt;%\n  left_join(ballparks %&gt;% select(nickname, home_lat = lat, home_lon = lon), \n            by = c(\"Home_Team\" = \"nickname\")) %&gt;%\n  left_join(ballparks %&gt;% select(nickname, away_lat = lat, away_lon = lon), \n            by = c(\"Away_Team\" = \"nickname\"))\n\nschedule_final &lt;- schedule_with_coords %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    miles = if_else(new_trip, \n                    calc_distance(away_lat, away_lon, home_lat, home_lon),\n                    0)\n  ) %&gt;%\n  ungroup()\n\n# WPG's travel\nschedule_final %&gt;%\n  filter(Away_Team == \"WPG\") %&gt;%\n  select(Date, Away_Team, Home_Team, new_trip, miles)\n\n# A tibble: 9 × 5\n  Date   Away_Team Home_Team new_trip miles\n  &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;lgl&gt;    &lt;dbl&gt;\n1 May 15 WPG       MKE       TRUE      650.\n2 May 16 WPG       MKE       FALSE       0 \n3 May 17 WPG       MKE       FALSE       0 \n4 May 26 WPG       GAR       TRUE      743.\n5 May 27 WPG       GAR       FALSE       0 \n6 May 28 WPG       GAR       FALSE       0 \n7 May 29 WPG       CHI       TRUE      705.\n8 May 30 WPG       CHI       FALSE       0 \n9 May 31 WPG       CHI       FALSE       0 \n\n# For each team, track their location game-by-game\ncalculate_all_travel &lt;- function() {\n  \n  teams &lt;- unique(c(schedule_clean$Home_Team, schedule_clean$Away_Team))\n  all_travel &lt;- list()\n  \n  for(team in teams) {\n    # Get all games for this team\n    team_games &lt;- schedule_clean %&gt;%\n      filter(Home_Team == team | Away_Team == team) %&gt;%\n      arrange(Date) %&gt;%\n      mutate(\n        location = if_else(Home_Team == team, team, Home_Team),\n        is_home = (Home_Team == team)\n      )\n    \n    # Start at home\n    current_location &lt;- team\n    trips &lt;- list()\n    \n    for(i in 1:nrow(team_games)) {\n      next_location &lt;- team_games$location[i]\n      \n      # Did they move?\n      if(current_location != next_location) {\n        from_coords &lt;- ballparks %&gt;% filter(nickname == current_location)\n        to_coords &lt;- ballparks %&gt;% filter(nickname == next_location)\n        \n        miles &lt;- calc_distance(\n          from_coords$lat, from_coords$lon,\n          to_coords$lat, to_coords$lon\n        )\n        \n        trips[[length(trips) + 1]] &lt;- tibble(\n          team = team,\n          date = team_games$Date[i],\n          from = current_location,\n          to = next_location,\n          miles = round(miles, 0)\n        )\n        \n        current_location &lt;- next_location\n      }\n    }\n    \n    if(length(trips) &gt; 0) {\n      all_travel[[team]] &lt;- bind_rows(trips)\n    }\n  }\n  \n  bind_rows(all_travel)\n}\n\n# Calculate for all teams\nall_trips &lt;- calculate_all_travel()\n\n# Show WPG's trips\nall_trips %&gt;%\n  filter(team == \"WPG\")\n\n# A tibble: 4 × 5\n  team  date   from  to    miles\n  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;\n1 WPG   May 15 WPG   MKE     650\n2 WPG   May 19 MKE   WPG     650\n3 WPG   May 26 WPG   GAR     743\n4 WPG   May 29 GAR   CHI      39\n\nall_trips %&gt;%\n  filter(team == \"FM\")\n\n# A tibble: 3 × 5\n  team  date   from  to    miles\n  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;\n1 FM    May 14 FM    CLE    1005\n2 FM    May 22 CLE   FM     1005\n3 FM    May 29 FM    SF      231\n\n# Summary by team\nteam_summary &lt;- all_trips %&gt;%\n  group_by(team) %&gt;%\n  summarise(\n    total_miles = sum(miles),\n    num_trips = n(),\n    ending_location = last(to)\n  ) %&gt;%\n  arrange(desc(total_miles))\n\nteam_summary\n\n# A tibble: 12 × 4\n   team  total_miles num_trips ending_location\n   &lt;chr&gt;       &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;          \n 1 FM           2241         3 SF             \n 2 WPG          2082         4 CHI            \n 3 LC           1770         4 LC             \n 4 MKE          1566         3 LC             \n 5 KCO          1448         3 KCO            \n 6 SC           1268         4 KC             \n 7 SF           1256         4 SF             \n 8 CHI          1193         3 CHI            \n 9 KC           1092         4 KC             \n10 CLE           924         3 GAR            \n11 LIN           671         3 KCO            \n12 GAR           245         3 GAR            \n\nall_trips\n\n# A tibble: 41 × 5\n   team  date   from  to    miles\n   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;\n 1 CLE   May 22 CLE   GAR     846\n 2 CLE   May 26 GAR   CHI      39\n 3 CLE   May 29 CHI   GAR      39\n 4 KCO   May 19 KCO   WPG     697\n 5 KCO   May 22 WPG   FM      209\n 6 KCO   May 27 FM    KCO     542\n 7 CHI   May 19 CHI   KC      406\n 8 CHI   May 22 KC    SF      325\n 9 CHI   May 26 SF    CHI     462\n10 MKE   May 22 MKE   WPG     650\n# ℹ 31 more rows"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "FISHFAN",
    "section": "",
    "text": "ballparks &lt;- read.csv(\"ballparks.csv\")\nprint(ballparks)\n\n                       Team        City State     lat      lon\n1              Chicago Dogs    Rosemont    IL 41.9740 -87.8820\n2   Fargo-Moorhead RedHawks       Fargo    ND 46.8770 -96.7890\n3  Gary SouthShore RailCats        Gary    IN 41.5934 -87.3365\n4       Kane County Cougars      Geneva    IL 41.8878 -88.3206\n5   Lake Country DockHounds  Oconomowoc    WI 43.1117 -88.4993\n6          Lincoln Saltdogs     Lincoln    NE 40.8508 -96.7008\n7         Milwaukee Milkmen    Franklin    WI 42.8864 -88.0384\n8      Sioux City Explorers  Sioux City    IA 42.4968 -96.3903\n9      Sioux Falls Canaries Sioux Falls    SD 43.5446 -96.7311\n10        Winnipeg Goldeyes    Winnipeg    MB 49.8951 -97.1384\n11     Kansas City Monarchs Kansas City    KS 39.1142 -94.6275\n12     Cleburne Railroaders    Cleburne    TX 32.3479 -97.3867\n\nplot(ballparks$lon, ballparks$lat, \n     pch = 19, col = \"red\",\n     xlab = \"Longitude\", ylab = \"Latitude\",\n     main = \"American Association Ballparks\")\ntext(ballparks$lon, ballparks$lat, \n     labels = ballparks$team, \n     pos = 4, cex = 0.6)"
  },
  {
    "objectID": "index.html#distance-analysis",
    "href": "index.html#distance-analysis",
    "title": "American Association",
    "section": "Distance Analysis",
    "text": "Distance Analysis\n\nDistance Matrix\n\n\n\n\n\n\n\n\nLongest Trips\n\n\n\n\n\n\n\n\n\n\n\nDistance Distribution\n\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead."
  },
  {
    "objectID": "index.html#summary-statistics",
    "href": "index.html#summary-statistics",
    "title": "American Association",
    "section": "Summary Statistics",
    "text": "Summary Statistics"
  },
  {
    "objectID": "index.html#ballpark-locations",
    "href": "index.html#ballpark-locations",
    "title": "American Association",
    "section": "Ballpark Locations",
    "text": "Ballpark Locations"
  },
  {
    "objectID": "index.html#distance-between-ballparks",
    "href": "index.html#distance-between-ballparks",
    "title": "American Association",
    "section": "Distance Between Ballparks",
    "text": "Distance Between Ballparks"
  },
  {
    "objectID": "Travel.html",
    "href": "Travel.html",
    "title": "Travel",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.6\n✔ forcats   1.0.1     ✔ stringr   1.6.0\n✔ ggplot2   4.0.1     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.2.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(geosphere)\nlibrary(DT)\n\nmay_schedule &lt;- read.csv(\"MAY_SCHEDULE.csv\")\ndatatable(may_schedule, rownames = FALSE)\n\n\n\n\nballparks &lt;- read.csv(\"ballparks.csv\")\ndatatable(ballparks,\n          rownames = FALSE,  \n          options = list(pageLength = 12))\n\n\n\n\nfirst_game &lt;- may_schedule[1,]\nhome_info &lt;- ballparks %&gt;% filter(nickname == first_game$Home_Team)\naway_info &lt;- ballparks %&gt;% filter(nickname == first_game$Away_Team)\n\n# Distance calculation function\ncalc_distance &lt;- function(lat1, lon1, lat2, lon2) {\n  distHaversine(c(lon1, lat1), c(lon2, lat2)) / 1609.34  # converts to miles\n}\n\n# Get coordinates\nhome_lat &lt;- home_info$lat\nhome_lon &lt;- home_info$lon\naway_lat &lt;- away_info$lat\naway_lon &lt;- away_info$lon\n# Sort by away team and date\nschedule_sorted &lt;- may_schedule %&gt;%\n  arrange(Away_Team, Date)\n\n# Add a column that shows if they're in a new city\nschedule_with_travel &lt;- schedule_sorted %&gt;%\n  group_by(Away_Team) %&gt;%\n  mutate(\n    prev_city = lag(Home_Team),  # Where they played last game\n    new_trip = (Home_Team != prev_city) | is.na(prev_city)  # TRUE if new city\n  ) %&gt;%\n  ungroup()\n\n# Look at this\nschedule_with_travel %&gt;%\n  select(Date, Away_Team, Home_Team, prev_city, new_trip) %&gt;%\n  head(20)\n\n# A tibble: 20 × 5\n   Date   Away_Team Home_Team prev_city new_trip\n   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;     &lt;lgl&gt;   \n 1 May 19 CHI       KC        &lt;NA&gt;      TRUE    \n 2 May 20 CHI       KC        KC        FALSE   \n 3 May 21 CHI       KC        KC        FALSE   \n 4 May 22 CHI       SF        KC        TRUE    \n 5 May 23 CHI       SF        SF        FALSE   \n 6 May 24 CHI       SF        SF        FALSE   \n 7 May 22 CLE       GAR       &lt;NA&gt;      TRUE    \n 8 May 23 CLE       GAR       GAR       FALSE   \n 9 May 24 CLE       GAR       GAR       FALSE   \n10 May 26 CLE       CHI       GAR       TRUE    \n11 May 27 CLE       CHI       CHI       FALSE   \n12 May 28 CLE       CHI       CHI       FALSE   \n13 May 29 CLE       GAR       CHI       TRUE    \n14 May 30 CLE       GAR       GAR       FALSE   \n15 May 31 CLE       GAR       GAR       FALSE   \n16 May 14 FM        CLE       &lt;NA&gt;      TRUE    \n17 May 15 FM        CLE       CLE       FALSE   \n18 May 16 FM        CLE       CLE       FALSE   \n19 May 17 FM        CLE       CLE       FALSE   \n20 May 19 FM        CLE       CLE       FALSE   \n\n# Calculate distance\ndistance &lt;- calc_distance(away_lat, away_lon, home_lat, home_lon)\nprint(paste(\"Distance from CLE to FM:\", round(distance, 0), \"miles\"))\n\n[1] \"Distance from CLE to FM: 1005 miles\"\n\n# For each team, track their location game-by-game\ncalculate_all_travel &lt;- function() {\n  \n  teams &lt;- unique(c(may_schedule$Home_Team, may_schedule$Away_Team))\n  all_travel &lt;- list()\n  \n  for(team in teams) {\n    # Get all games for this team\n    team_games &lt;- may_schedule %&gt;%\n      filter(Home_Team == team | Away_Team == team) %&gt;%\n      arrange(Date) %&gt;%\n      mutate(\n        location = if_else(Home_Team == team, team, Home_Team),\n        is_home = (Home_Team == team)\n      )\n    \n    # Start at home\n    current_location &lt;- team\n    trips &lt;- list()\n    \n    for(i in 1:nrow(team_games)) {\n      next_location &lt;- team_games$location[i]\n      \n      # Did they move?\n      if(current_location != next_location) {\n        from_coords &lt;- ballparks %&gt;% filter(nickname == current_location)\n        to_coords &lt;- ballparks %&gt;% filter(nickname == next_location)\n        \n        if(nrow(from_coords) == 0 || nrow(to_coords) == 0) {\n          warning(paste(\"missing coords for\", current_location, \"or\", next_location))\n          next\n        }\n        \n        miles &lt;- calc_distance(\n          from_coords$lat, from_coords$lon,\n          to_coords$lat, to_coords$lon\n        )\n        \n        trips[[length(trips) + 1]] &lt;- tibble(\n          team = team,\n          date = team_games$Date[i],\n          from = current_location,\n          to = next_location,\n          miles = round(miles, 0)\n        )\n        \n        current_location &lt;- next_location\n      }\n    }\n    \n    if(length(trips) &gt; 0) {\n      all_travel[[team]] &lt;- bind_rows(trips)\n    }\n  }\n  \n  bind_rows(all_travel)\n}\n\n# Calculate for all teams\nall_trips &lt;- calculate_all_travel()\n\nWarning in calculate_all_travel(): missing coords for SF or LIN\nWarning in calculate_all_travel(): missing coords for SF or LIN\nWarning in calculate_all_travel(): missing coords for SF or LIN\n\n\nWarning in calculate_all_travel(): missing coords for SF or KCO\nWarning in calculate_all_travel(): missing coords for SF or KCO\n\n\nWarning in calculate_all_travel(): missing coords for FM or CLE\nWarning in calculate_all_travel(): missing coords for FM or CLE\n\n\nWarning in calculate_all_travel(): missing coords for FM or SF\n\n\nWarning in calculate_all_travel(): missing coords for LC or SF\nWarning in calculate_all_travel(): missing coords for LC or SF\nWarning in calculate_all_travel(): missing coords for LC or SF\nWarning in calculate_all_travel(): missing coords for LC or SF\n\n\nWarning in calculate_all_travel(): missing coords for LC or FM\n\n\nWarning in calculate_all_travel(): missing coords for KCO or WPG\n\n\nWarning in calculate_all_travel(): missing coords for KCO or FM\n\n\nWarning in calculate_all_travel(): missing coords for MKE or WPG\nWarning in calculate_all_travel(): missing coords for MKE or WPG\nWarning in calculate_all_travel(): missing coords for MKE or WPG\n\n\nWarning in calculate_all_travel(): missing coords for MKE or SC\nWarning in calculate_all_travel(): missing coords for MKE or SC\nWarning in calculate_all_travel(): missing coords for MKE or SC\nWarning in calculate_all_travel(): missing coords for MKE or SC\n\n\nWarning in calculate_all_travel(): missing coords for MKE or LC\nWarning in calculate_all_travel(): missing coords for MKE or LC\nWarning in calculate_all_travel(): missing coords for MKE or LC\n\n# Show WPG's trips\n#all_trips %&gt;%\n # filter(team == \"WPG\")"
  }
]